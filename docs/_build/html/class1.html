
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DDoS and DNS DoS Lab &#8212; F5 BIG-IP DDoS and DNS DoS Protections  documentation</title>
    
    <link rel="stylesheet" href="_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/f5_agility_theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<!--
# Copyright 2017 F5 Networks
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
-->
<link href="https://cdn.f5.com/favicon.ico" rel="icon">
<script src="https://use.fontawesome.com/21fb8a09c3.js"></script>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>
  <body>
  <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="row corp-header">
      <div class="container corp-header">
        <div class="container corp-menu">
          <ul>
            <li><a href="https://f5.com" class="internalLink">F5.com</a></li>
            <li><a href="https://support.f5.com">Support</a></li>
            <li><a href="https://devcentral.f5.com">Community</a></li>
            <li><a href="https://github.com/F5Networks">GitHub</a></li>
            <li><a href="https://f5.com/about-us/careers">Careers</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="row pageHeader">
      <div class="container stat">
        <div class="col-xs-12 stat">
          <a class="internalLink" href="https://f5.com">
            <img class="logo" src="https://cdn.f5.com/websites/support/assets/images/logo.svg" width="50" height="44" alt="F5 Networks" title="F5 Networks" border="0">
          </a>
            <ul id="MainMenu" class="main-menu">
              <li>
                <a href="#">Products
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>

                <div class="menu-panel soft-hide" id="ProductsSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third"><span class="a-mm-h">Connectors</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/products/connectors/marathon-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 Marathon BIG-IP Controller</a></li>
                          <li><a href="http://clouddocs.f5.com/products/connectors/marathon-asp-ctlr/latest" data-link-type="Nav: Mega">F5 Marathon ASP Controller</a></li>
                          <li><a href="http://clouddocs.f5.com/products/connectors/k8s-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 Kubernetes BIG-IP Controller</a></li>
                          <li><a href="http://clouddocs.f5.com/products/connectors/f5-kube-proxy/latest" data-link-type="Nav: Mega">F5 Kubernetes Proxy</a></li>
                        </ul>
                        <!--span class="seemore"><a data-link-type="Nav: Mega" href="/products/connectors">See all </a></--span-->
                      </li>
                      <li class="divider"></li>
                      <li class="third"><span class="a-mm-h">Application Service Proxy</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/products/asp/latest" data-link-type="Nav: Mega">F5 Application Service Proxy</a></li>
                        </ul>
                        <!--span class="seemore"><a href="/products/">See all </a></span-->
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
              <li>
                <a href="#">Container Integrations
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>

                <div class="menu-panel soft-hide" id="ContainersSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third"><span class="a-mm-h">Container Integrations</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/containers/latest/marathon/" data-link-type="Nav: Mega">Mesos Marathon</a></li>
                          <li><a href="http://clouddocs.f5.com/containers/latest/kubernetes/" data-link-type="Nav: Mega">Kubernetes</a></li>
                          <li><a href="http://clouddocs.f5.com/containers/latest/openshift/" data-link-type="Nav: Mega">RedHat OpenShift</a></li>
                        </ul>
                        <span class="seemore"><a data-link-type="Nav: Mega" href="http://clouddocs.f5.com/containers/latest">View details </a></span>
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
              <li>
                <a href="#">Clouds
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>

                <div class="menu-panel soft-hide" id="CloudsSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third"><span class="a-mm-h">Cloud Integrations</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/cloud/openstack/" data-link-type="Nav: Mega">OpenStack</a></li>
                        </ul>
                        <!--span class="seemore"><a data-link-type="Nav: Mega" href="/cloud/">See all </a></span-->
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
              <li>
                <a href="#">Resources
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>
                <div class="menu-panel soft-hide" id="UPCProgramSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third">
                        <span class="a-mm-h">Downloads</span>
                        <ul>
                          <li><a target="_blank" data-link-type="Nav: Mega" href="https://hub.docker.com/r/f5networks/" class="internalLink">Docker Hub</a></li>
                          <li><a target="_blank" data-link-type="Nav: Mega" href="https://store.docker.com/images/f5networks" class="internalLink">Docker Store</a></li>
                        </ul>
                      </li>
                      <li class="divider"></li>

                      <li class="third">
                        <span class="a-mm-h">OpenSource</span>
                        <ul>
                          <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5Networks" class="internalLink">GitHub</a></li>
                        </ul>
                      </li>
                      <li class="divider"></li>

                      <li class="third">
                        <a href="//university.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega">F5 University</a>
                        <ul>
                          <li>
                            <p>Get up to speed with free self-paced courses</p>
                          </li>
                        </ul>
                        <a data-ng-href="https://devcentral.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega" href="https://devcentral.f5.com">DevCentral</a>
                        <ul>
                          <li>
                            <p>Join the community of 250,000+ technical peers</p>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
            </ul>
        </div>
      </div>
    </div>
  </div> <!-- /container-fluid -->
</nav>

  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-3 col-md-3 sidebar">
         <h4><a href="./">F5 BIG-IP DDoS and DNS DoS Protections </a></h4>
<div id="searchbox" style="display: none" role="search">
  <form class="search" action="search.html" method="get">
    <div>
      <input type="text" name="q" placeholder="Search" style="padding-left: 6px;"/>
      <!-- <input type="submit" value="Go" style="margin-top: 4px;"/> -->
      <button type="submit" class="btn btn-primary btn-xs">Go</button>
    </div>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <p class="caption">
   <span class="caption-text">Current Page</span>
  </p>
  <ul>
<li><a class="reference internal" href="#">DDoS and DNS DoS Lab</a><ul>
<li><a class="reference internal" href="#base-big-ip-configuration">Base BIG-IP Configuration</a></li>
<li><a class="reference internal" href="#detecting-and-preventing-dns-dos-attacks-on-a-virtual-server">Detecting and Preventing DNS DoS Attacks on a Virtual Server</a><ul>
<li><a class="reference internal" href="#establishing-a-dns-server-baseline">Establishing a DNS server baseline</a></li>
<li><a class="reference internal" href="#configuring-a-dos-logging-profile">Configuring a DoS Logging Profile</a></li>
<li><a class="reference internal" href="#configuring-a-dos-profile">Configuring a DoS Profile</a></li>
<li><a class="reference internal" href="#attaching-a-dos-profile">Attaching a DoS Profile</a></li>
<li><a class="reference internal" href="#simulate-a-dns-ddos-attack">Simulate a DNS DDoS Attack</a></li>
<li><a class="reference internal" href="#dns-ddos-mitigations-for-continued-service">DNS DDoS Mitigations for Continued Service</a><ul>
<li><a class="reference internal" href="#bad-actor-detection">Bad Actor Detection</a></li>
<li><a class="reference internal" href="#remote-triggered-black-holing">Remote Triggered Black Holing</a></li>
<li><a class="reference internal" href="#silverline-mitigation">Silverline Mitigation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#filtering-specific-dns-operations">Filtering specific DNS operations</a></li>
<li><a class="reference internal" href="#detecting-and-preventing-system-dos-and-ddos-attacks">Detecting and Preventing System DoS and DDoS Attacks</a><ul>
<li><a class="reference internal" href="#configure-logging">Configure Logging</a></li>
<li><a class="reference internal" href="#simulating-a-christmas-tree-packet-attack">Simulating a Christmas Tree Packet Attack</a></li>
<li><a class="reference internal" href="#simulating-a-tcp-syn-ddos-attack">Simulating a TCP SYN DDoS Attack</a></li>
</ul>
</li>
<li><a class="reference internal" href="#preventing-global-dos-sweep-and-flood-attacks">Preventing Global DoS Sweep and Flood Attacks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion"><em>Conclusion</em></a></li>
<li><a class="reference internal" href="#appendix"><em>Appendix</em></a><ul>
<li><a class="reference internal" href="#software-download-locations">Software Download Locations</a></li>
<li><a class="reference internal" href="#lab-build-images-and-sizing">Lab build images and sizing</a></li>
<li><a class="reference internal" href="#attack-host-build-from-scratch">Attack Host Build from Scratch</a><ul>
<li><a class="reference internal" href="#dnsperf-install">DNSPerf Install</a></li>
<li><a class="reference internal" href="#install-hping3">Install hping3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#victim-server-setup-from-scratch">Victim Server Setup from Scratch</a><ul>
<li><a class="reference internal" href="#install-bind9">Install bind9</a></li>
<li><a class="reference internal" href="#set-the-named-conf-options-configuration">Set the named.conf.options configuration</a></li>
<li><a class="reference internal" href="#create-a-new-dns-zone">Create a new DNS zone</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dns-security-vectors">DNS Security vectors</a></li>
<li><a class="reference internal" href="#network-security-vectors">Network Security Vectors</a></li>
</ul>
</li>
</ul>


<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Detecting and Protecting Against DDoS and DNS Protocol Attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="class1/class1.html">2. Class - F5 BIG-IP DDoS and DNS DoS Protections</a></li>
</ul>

        
      </div>
      <div class="col-md-offset-3 col-sm-offset-3 main">
        <h4>
          <a href="/">Community Training Classes &amp; Labs</a> &gt; <a href="index.html">F5 BIG-IP DDoS and DNS DoS Protections</a>
          <span class="right"><a href="genindex.html">Index</a></span>
        </h4>
        
  <div class="section" id="ddos-and-dns-dos-lab">
<h1>DDoS and DNS DoS Lab<a class="headerlink" href="#ddos-and-dns-dos-lab" title="Permalink to this headline">¶</a></h1>
<div class="section" id="base-big-ip-configuration">
<h2>Base BIG-IP Configuration<a class="headerlink" href="#base-big-ip-configuration" title="Permalink to this headline">¶</a></h2>
<p>In this lab, the VE has been configured with the basic system settings
and the VLAN/self-IP configurations required for the BIG-IP to
communicate and pass traffic on the network. We’ll now need to configure
the BIG-IP to listen for traffic and pass it to the back end server.</p>
<ol class="arabic">
<li><p class="first">Launch the Firefox shortcut titled <strong>Launch BIG-IP Web UI</strong> on the
desktop of your lab jump server. The credentials for the BIG-IP are
conveniently displayed in the login banner. Just in case: <strong>admin /
401elliottW!</strong></p>
</li>
<li><p class="first">Navigate to <strong>Local Traffic</strong> &gt; <strong>Nodes</strong> and create a new node with
the following settings, leaving unspecified fields at their default
value:</p>
<ol class="loweralpha">
<li><p class="first">Name: lab-server-10.10.0.50</p>
</li>
<li><div class="first line-block">
<div class="line">Address: 10.10.0.50</div>
<div class="line"><a class="reference internal" href="media/image6.png"><img alt="image4" src="media/image6.png" style="width: 3.94702in; height: 3.80739in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Finished</strong> to add the new node.</p>
</li>
<li><p class="first">Navigate to <strong>Local Traffic</strong> &gt; <strong>Pools</strong> and create a new pool with
the following settings, leaving unspecified attributes at their
default value:</p>
<ol class="loweralpha">
<li><p class="first">Name: lab-server-pool</p>
</li>
<li><p class="first">Health Monitors: gateway_icmp</p>
</li>
<li><p class="first">New Members: Node List</p>
<ol class="lowerroman">
<li><p class="first">Address: lab-server-10.10.0.50</p>
</li>
<li><p class="first">Service Port: * (All Ports)</p>
</li>
<li><div class="first line-block">
<div class="line">Click <strong>Add</strong> to add the new member to the member list.</div>
<div class="line"><a class="reference internal" href="media/image7.png"><img alt="image5" src="media/image7.png" style="width: 4.75828in; height: 4.42937in;" /></a></div>
</div>
</li>
</ol>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Finished</strong> to create the new pool.</p>
</li>
<li><p class="first">Because the attack server will be sending a huge amount of traffic,
we’ll need a fairly large SNAT pool. Navigate to <strong>Local Traffic</strong> &gt;
<strong>Address Translation</strong> &gt; <strong>SNAT Pool List</strong> and create a new SNAT
pool with the following attributes:</p>
<ol class="loweralpha simple">
<li>Name: inside_snat_pool</li>
<li>Member List: 10.10.0.125, 10.10.0.126, 10.10.0.127, 10.10.0.128,
10.10.0.129, 10.10.0.130 <a class="reference internal" href="media/image8.png"><img alt="image6" src="media/image8.png" style="width: 4.72535in; height: 3.47384in;" /></a></li>
</ol>
</li>
<li><p class="first">Click <strong>Finished</strong> to commit your changes.</p>
</li>
<li><p class="first">Navigate to <strong>Local Traffic</strong> &gt; <strong>Virtual Servers</strong> and create a new
virtual server with the following settings, leaving unspecified
fields at their default value:</p>
<ol class="loweralpha">
<li><p class="first">Name: udp_dns_VS</p>
</li>
<li><p class="first">Destination Address/Mask: 10.20.0.10</p>
</li>
<li><p class="first">Service Port: 53</p>
</li>
<li><p class="first">Protocol: UDP</p>
</li>
<li><p class="first">Source Address Translation: SNAT</p>
</li>
<li><p class="first">SNAT Pool: inside_snat_pool</p>
</li>
<li><div class="first line-block">
<div class="line">Default Pool: lab-server-pool</div>
<div class="line"><a class="reference internal" href="media/image9.png"><img alt="image7" src="media/image9.png" style="width: 3.80731in; height: 8.22517in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Finished</strong>.</p>
</li>
<li><p class="first">We’ll now test the new DNS virtual server. SSH into the attack host
by clicking the “Attack Host (Ubuntu)” icon on the jump host
desktop.</p>
</li>
<li><p class="first">Issue the dig &#64;10.20.0.10
<a class="reference external" href="http://www.example.com">www.example.com</a> +short command on the
BASH CLI of the attack host. You should see output similar to:
<a class="reference internal" href="media/image10.png"><img alt="image8" src="media/image10.png" style="width: 6.16667in; height: 0.44444in;" /></a>This verifies that DNS traffic is passing through the
BIG-IP.</p>
</li>
<li><p class="first">Return to the BIG-IP and navigate to <strong>Local Traffic</strong> &gt; <strong>Virtual
Servers</strong> and create a new virtual server with the following
settings, leaving unspecified fields at their default value:</p>
<ol class="loweralpha simple">
<li>Name: other_protocols_VS</li>
<li>Destination Address/Mask: 10.20.0.10</li>
<li>Service Port: * (All Ports)</li>
<li>Protocol: * All Protocols</li>
<li>Any IP Profile: ipother</li>
<li>Source Address Translation: SNAT</li>
<li>SNAT Pool: inside_snat_pool</li>
<li>Default Pool: lab-server-pool <a class="reference internal" href="media/image11.png"><img alt="image9" src="media/image11.png" style="width: 4.73472in; height: 6.05700in;" /></a></li>
</ol>
</li>
<li><p class="first">Return to the Attack Host SSH session and attempt to SSH to the
server using SSH 10.20.0.10. Simply verify that you are prompted for
credentials and press CTRL+C to cancel the session. This verifies
that non-DNS traffic is now flowing through the BIG-IP.</p>
</li>
</ol>
<p><strong>MILESTONE REACHED: At this point, you have a functional server, an
attack host with tools needed to simulate DoS/DNS attacks, and a BIG-IP
with a base configuration that allows the attack host to reach the
victim server. This is a great starting point if you wish to create your
own custom proof of concept.</strong></p>
</div>
<div class="section" id="detecting-and-preventing-dns-dos-attacks-on-a-virtual-server">
<h2>Detecting and Preventing DNS DoS Attacks on a Virtual Server<a class="headerlink" href="#detecting-and-preventing-dns-dos-attacks-on-a-virtual-server" title="Permalink to this headline">¶</a></h2>
<div class="section" id="establishing-a-dns-server-baseline">
<h3>Establishing a DNS server baseline<a class="headerlink" href="#establishing-a-dns-server-baseline" title="Permalink to this headline">¶</a></h3>
<p>Before we can attack our DNS server, we should establish a baseline for
how many QPS our DNS server can handle. For this lab, let’s find the
magic number of QPS that causes 50% CPU utilization on the BIND process.</p>
<ol class="arabic">
<li><p class="first">Connect to the Victim Server SSH session by double-clicking the
<strong>Victim Server (Ubuntu)</strong> shortcut on the jump host desktop.</p>
</li>
<li><p class="first">From the BASH prompt, enter <strong>top</strong> and press <strong>Enter</strong> to start the
top utility.</p>
</li>
<li><p class="first">You will see a list of running processes sorted by CPU utilization,
like the output below:</p>
<p><a class="reference internal" href="media/image12.png"><img alt="image10" src="media/image12.png" style="width: 5.60000in; height: 3.53333in;" /></a></p>
</li>
<li><p class="first">Connect to the Attack Host SSH session by double-clicking the
<strong>Attack Host (Ubuntu)</strong> shortcut on the jump host desktop.</p>
</li>
<li><div class="first line-block">
<div class="line">Start by sending 500 DNS QPS for 30 seconds to the host using the
following syntax:</div>
<div class="line">dnsperf -s 10.20.0.10 -d queryfile-example-current -c 20 -T 20 -l
30 -q 10000 -Q 500</div>
</div>
</li>
<li><p class="first">Observe CPU utilization over the 30 second window for the <strong>named</strong>
process. If the CPU utilization is below 45%, increase the QPS by
increasing the -Q value. If the CPU utilization is above 55%,
decrease the QPS.</p>
</li>
<li><p class="first">Record the QPS required to achieve a sustained CPU utilization of
approximately 50%. Consider this the QPS that the server can safely
sustain for demonstration purposes.</p>
</li>
<li><div class="first line-block">
<div class="line">Now, attack the DNS server with 10,000 QPS using the following
syntax:</div>
<div class="line">dnsperf -s 10.20.0.10 -d queryfile-example-current -c 20 -T 20 -l
30 -q 10000 -Q 10000</div>
</div>
</li>
<li><p class="first">You’ll notice that the CPU utilization on the victim server
skyrockets, as well as DNS query timeout errors appearing on the
attack server’s SSH session. This shows your DNS server is
overwhelmed.</p>
</li>
</ol>
</div>
<div class="section" id="configuring-a-dos-logging-profile">
<h3>Configuring a DoS Logging Profile<a class="headerlink" href="#configuring-a-dos-logging-profile" title="Permalink to this headline">¶</a></h3>
<p>We’ll create a DoS logging profile so that we can see event logs in the
BIG-IP UI during attack mitigation.</p>
<ol class="arabic">
<li><p class="first">On the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt;
<strong>Logging Profiles</strong> and create a new profile with the following
values, leaving unspecified attributes at their default value:</p>
<ol class="loweralpha">
<li><p class="first">Profile Name: dns-dos-profile-logging</p>
</li>
<li><p class="first">DoS Protection: Enabled</p>
</li>
<li><div class="first line-block">
<div class="line">DNS DoS Protection Publisher: local-db-publisher</div>
<div class="line"><a class="reference internal" href="media/image13.png"><img alt="image11" src="media/image13.png" style="width: 4.04500in; height: 5.58775in;" /></a></div>
</div>
</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="configuring-a-dos-profile">
<h3>Configuring a DoS Profile<a class="headerlink" href="#configuring-a-dos-profile" title="Permalink to this headline">¶</a></h3>
<p>We’ll now create a DoS profile with manually configured thresholds to
limit the attack’s effect on our server.</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line">Navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong> &gt; <strong>DoS Profiles</strong>
and create a new DoS profile with the name <strong>dns-dos-profile</strong>.</div>
<div class="line"><a class="reference internal" href="media/image14.png"><img alt="image12" src="media/image14.png" style="width: 4.94444in; height: 2.29167in;" /></a></div>
</div>
</li>
<li><p class="first">The UI will return to the DoS Profiles list. Click the
<strong>dns-dos-profile</strong> name.</p>
</li>
<li><p class="first">Click the <strong>Protocol Security</strong> tab and select <strong>DNS Security</strong> from
the drop-down.</p>
</li>
<li><p class="first">Click the <strong>DNS A Query</strong> vector from the Attack Type list.</p>
</li>
<li><p class="first">Modify the <strong>DNS A Query</strong> vector configuration to match the
following values, leaving unspecified attributes with their default
value:</p>
<ol class="loweralpha">
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: (Set this at 80% of your safe QPS value)</p>
</li>
<li><div class="first line-block">
<div class="line">Mitigation Threshold EPS: (Set this to your safe QPS value)</div>
<div class="line"><a class="reference internal" href="media/image15.png"><img alt="image13" src="media/image15.png" style="width: 3.54305in; height: 4.68726in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Make sure that you click <strong>Update</strong> to save your changes.</p>
</li>
</ol>
</div>
<div class="section" id="attaching-a-dos-profile">
<h3>Attaching a DoS Profile<a class="headerlink" href="#attaching-a-dos-profile" title="Permalink to this headline">¶</a></h3>
<p>We’ll attach the DoS profile to the virtual server that we configured to
manage DNS traffic.</p>
<ol class="arabic simple">
<li>Navigate to <strong>Local Traffic</strong> &gt; <strong>Virtual Servers</strong> &gt; <strong>Virtual
Server List</strong>.</li>
<li>Click on the <strong>udp_dns_VS</strong> name.</li>
<li>Click on the <strong>Security</strong> tab and select <strong>Policies</strong>.</li>
<li>In the <strong>DoS Protection Profile</strong> field, select <strong>Enabled</strong> and
choose the <strong>dns-dos-profile</strong>.</li>
<li>In the <strong>Log Profile</strong>, select <strong>Enabled</strong> and move the
<strong>dns-dos-profile-logging</strong> profile from <strong>Available</strong> to
<strong>Selected</strong>.</li>
<li>Click <strong>Update</strong>.</li>
</ol>
</div>
<div class="section" id="simulate-a-dns-ddos-attack">
<h3>Simulate a DNS DDoS Attack<a class="headerlink" href="#simulate-a-dns-ddos-attack" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Open the SSH session to the victim server and ensure the top utility
is running.</p>
</li>
<li><div class="first line-block">
<div class="line">Once again, attack your DNS server from the attack host using the
following syntax:</div>
<div class="line">dnsperf -s 10.20.0.10 -d queryfile-example-current -c 20 -T 20 -l
30 -q 10000 -Q 10000</div>
</div>
</li>
<li><p class="first">On the server SSH session running the top utility, notice the CPU
utilization on your server remains in a range that ensures the DNS
server is not overwhelmed.</p>
</li>
<li><div class="first line-block">
<div class="line">After the attack, navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt;
<strong>DoS</strong> &gt; <strong>DNS Protocol</strong>. Observe the logs to see the mitigation
actions taken by the BIG-IP.</div>
<div class="line"><a class="reference internal" href="media/image16.tiff"><img alt="image14" src="media/image16.tiff" style="width: 6.50000in; height: 2.78542in;" /></a></div>
</div>
</li>
</ol>
</div>
<div class="section" id="dns-ddos-mitigations-for-continued-service">
<h3>DNS DDoS Mitigations for Continued Service<a class="headerlink" href="#dns-ddos-mitigations-for-continued-service" title="Permalink to this headline">¶</a></h3>
<p>At this point, you’ve successfully configured the BIG-IP to limit the
amount of resource utilization on the BIG-IP. Unfortunately, even valid
DNS requests can be caught in the mitigation we’ve configured. There are
further steps that can be taken to mitigate the attack that will allow
non-malicious DNS queries.</p>
<div class="section" id="bad-actor-detection">
<h4>Bad Actor Detection<a class="headerlink" href="#bad-actor-detection" title="Permalink to this headline">¶</a></h4>
<p>Bad actor detection and blacklisting allows us to completely block
communications from malicious hosts at the BIG-IP, completely preventing
those hosts from reaching the back-end servers. To demonstrate:</p>
<ol class="arabic">
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong> &gt; <strong>DoS Profiles</strong>.</p>
</li>
<li><p class="first">Click on the <strong>dns-dos-profile</strong> profile name.</p>
</li>
<li><p class="first">Click on the <strong>Protocol Security</strong> tab then select <strong>DNS Security</strong>.</p>
</li>
<li><p class="first">Click on the <strong>DNS A Query</strong> attack type name.</p>
</li>
<li><p class="first">Modify the vector as follows:</p>
<ol class="loweralpha">
<li><p class="first">Bad Actor Detection: Checked</p>
</li>
<li><p class="first">Per Source IP Detection Threshold EPS: 80</p>
</li>
<li><p class="first">Per Source IP Mitigation Threshold EPS: 100</p>
</li>
<li><p class="first">Add Source Address to Category: Checked</p>
</li>
<li><p class="first">Category Name: denial_of_service</p>
</li>
<li><p class="first">Sustained Attack Detection Time: 15 seconds</p>
</li>
<li><div class="first line-block">
<div class="line">Category Duration Time: 60 seconds</div>
<div class="line"><a class="reference internal" href="media/image17.png"><img alt="image15" src="media/image17.png" style="width: 2.67129in; height: 5.81457in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Make sure you click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Network Firewall</strong> &gt; <strong>IP
Intelligence</strong> &gt; <strong>Policies</strong> and create a new IP Intelligence
policy with the following values, leaving unspecified attributes at
their default values:</p>
<ol class="loweralpha simple">
<li>Name: dns-bad-actor-blocking</li>
<li>Default Log Actions section:<ol class="lowerroman">
<li>Log Blacklist Category Matches: Yes</li>
</ol>
</li>
<li>Blacklist Matching Policy<ol class="lowerroman">
<li>Create a new blacklist matching policy:<ol class="arabic">
<li>Blacklist Category: denial_of_service</li>
<li><a class="reference internal" href="media/image18.png"><img alt="image16" src="media/image18.png" style="width: 6.22083in; height: 3.67500in;" /></a>Click <strong>Add</strong> to add the policy.</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Finished</strong>.</p>
</li>
<li><p class="first">Navigate to <strong>Local Traffic</strong> &gt; <strong>Virtual Servers</strong> &gt; <strong>Virtual
Server List</strong>.</p>
</li>
<li><p class="first">Click on the <strong>udp_dns_VS</strong> virtual server name.</p>
</li>
<li><p class="first">Click on the <strong>Security</strong> tab and select <strong>Policies</strong>.</p>
</li>
<li><div class="first line-block">
<div class="line">Enable <strong>IP Intelligence</strong> and choose the
<strong>dns-bad-actor-blocking</strong> policy.</div>
<div class="line"><a class="reference internal" href="media/image19.png"><img alt="image17" src="media/image19.png" style="width: 3.81074in; height: 5.31788in;" /></a></div>
</div>
</li>
<li><p class="first">Make sure you click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Logging Profiles</strong>.</p>
</li>
<li><p class="first">Click the <strong>global-network</strong> logging profile name.</p>
</li>
<li><div class="first line-block">
<div class="line">Under the <strong>Network Firewall</strong> tab, set the IP Intelligence
Publisher to <strong>local-db-publisher</strong> and check <strong>Log Shun Events</strong>.</div>
<div class="line"><a class="reference internal" href="media/image20.png"><img alt="image18" src="media/image20.png" style="width: 4.17881in; height: 2.18072in;" /></a></div>
</div>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Click the <strong>dns-dos-profile-logging</strong> logging profile name.</p>
</li>
<li><div class="first line-block">
<div class="line">Check <strong>Enabled</strong> next to <strong>Network Firewall</strong>.</div>
<div class="line"><a class="reference internal" href="media/image21.png"><img alt="image19" src="media/image21.png" style="width: 3.40297in; height: 3.22001in;" /></a></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">Under the <strong>Network Firewall</strong> tab, change the <strong>Network
Firewall</strong> and <strong>IP Intelligence Publisher</strong> to
<strong>local-db-publisher</strong> and click <strong>Update</strong>.</div>
<div class="line"><a class="reference internal" href="media/image22.tiff"><img alt="image20" src="media/image22.tiff" style="width: 3.15278in; height: 3.98611in;" /></a></div>
</div>
</li>
<li><p class="first">Bring into view the Victim Server SSH session running the top
utility to monitor CPU utilization.</p>
</li>
<li><div class="first line-block">
<div class="line">On the Attack Server host, launch the DNS attack once again using
the following syntax:</div>
<div class="line">dnsperf -s 10.20.0.10 -d queryfile-example-current -c 20 -T 20 -l
30 -q 10000 -Q 10000</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">You’ll notice CPU utilization on the victim server begin to climb,
but slowly drop. The attack host will show that queries are timing
out as shown below. This is due to the BIG-IP blacklisting the bad
actor.</div>
<div class="line"><a class="reference internal" href="media/image23.tiff"><img alt="image21" src="media/image23.tiff" style="width: 2.36111in; height: 0.68056in;" /></a></div>
</div>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the bad actor blocking mitigation logs.</p>
</li>
<li><div class="first line-block">
<div class="line">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt;
<strong>Shun</strong>. This screen shows the bad actor being added to (and
later deleted from) the shun category.</div>
<div class="line"><a class="reference internal" href="media/image24.tiff"><img alt="image22" src="media/image24.tiff" style="width: 4.87500in; height: 1.68056in;" /></a></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>Protocol</strong> &gt; <strong>DNS</strong>.
Change the <strong>View By</strong> drop-down to view various statistics around
the DNS traffic and attacks.</div>
<div class="line"><a class="reference internal" href="media/image25.tiff"><img alt="image23" src="media/image25.tiff" style="width: 4.32450in; height: 3.69594in;" /></a></div>
</div>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. The default view may be blank. Change the <strong>View
By</strong> drop-down to view various statistics around the IP Intelligence
handling of the attack traffic.</p>
</li>
<li><div class="first line-block">
<div class="line">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Dashboard</strong>
to view an overview of the DoS attacks and timeline. You can
select filters in the filter pane to highlight specific attacks.</div>
<div class="line"><a class="reference internal" href="media/image26.tiff"><img alt="image24" src="media/image26.tiff" style="width: 5.00000in; height: 4.06944in;" /></a></div>
</div>
</li>
<li><p class="first">Finally, navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt;
<strong>Analysis</strong>. View detailed statistics around each attack.</p>
</li>
</ol>
</div>
<div class="section" id="remote-triggered-black-holing">
<h4>Remote Triggered Black Holing<a class="headerlink" href="#remote-triggered-black-holing" title="Permalink to this headline">¶</a></h4>
<p>The BIG-IP supports the advertisement of bad actor(s) to upstream
devices via BGP to block malicious traffic closer to the source. This is
accomplished by publishing a blacklist to an external resource. This is
not demonstrated in this lab.</p>
</div>
<div class="section" id="silverline-mitigation">
<h4>Silverline Mitigation<a class="headerlink" href="#silverline-mitigation" title="Permalink to this headline">¶</a></h4>
<p>Silverline offers “always on” and “on demand” DDoS scrubbing that could
assist in this scenario as well. This is not demonstrated in this lab.</p>
</div>
</div>
</div>
<div class="section" id="filtering-specific-dns-operations">
<h2>Filtering specific DNS operations<a class="headerlink" href="#filtering-specific-dns-operations" title="Permalink to this headline">¶</a></h2>
<p>The BIG-IP offers the ability to filter DNS query types and header
opcodes to act as a DNS firewall. To demonstrate, we will block MX
queries from our DNS server.</p>
<ol class="arabic">
<li><p class="first">Open the SSH session to the attack host.</p>
</li>
<li><div class="first line-block">
<div class="line">Perform an MX record lookup by issuing the following command:</div>
<div class="line">dig &#64;10.20.0.10 MX example.com</div>
</div>
</li>
<li><p class="first">The server doesn’t have a record for this domain. This server
doesn’t have MX records, so those requests should be filtered</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Protocol Security</strong> &gt; <strong>Security
Profiles</strong> &gt; <strong>DNS</strong> and create a new DNS security profile with the
following values, leaving unspecified attributes at their default
value:</p>
<ol class="loweralpha">
<li><p class="first">Name: dns-block-mx-query</p>
</li>
<li><div class="first line-block">
<div class="line">Query Type Filter: move mx from Available to Active</div>
<div class="line"><a class="reference internal" href="media/image27.png"><img alt="image25" src="media/image27.png" style="width: 3.89968in; height: 3.43639in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Navigate to <strong>Local Traffic</strong> &gt; <strong>Profiles</strong> &gt; <strong>Services</strong> &gt;
<strong>DNS</strong>. <strong>NOTE:</strong> if you are mousing over the services, DNS may not
show up on the list. Select <strong>Services</strong> and then use the pulldown
menu on services to select <strong>DNS</strong>.</p>
</li>
<li><p class="first">Create a new DNS services profile with the following values, leaving
unspecified values at their default values:</p>
<ol class="loweralpha">
<li><p class="first">Name: dns-block-mx</p>
</li>
<li><p class="first">DNS Traffic</p>
<ol class="lowerroman">
<li><p class="first">DNS Security: Enabled</p>
</li>
<li><div class="first line-block">
<div class="line">DNS Security Profile Name: dns-block-mx-query</div>
<div class="line"><a class="reference internal" href="media/image28.png"><img alt="image26" src="media/image28.png" style="width: 2.60017in; height: 6.93378in;" /></a></div>
</div>
</li>
</ol>
</li>
</ol>
</li>
<li><p class="first">Navigate to <strong>Local Traffic</strong> &gt; <strong>Virtual Servers</strong> &gt; <strong>Virtual
Server List</strong>.</p>
</li>
<li><p class="first">Click on the <strong>udp_dns_VS</strong> virtual server name.</p>
</li>
<li><p class="first">In the <strong>Configuration</strong> section, change the view to <strong>Advanced</strong>.</p>
</li>
<li><div class="first line-block">
<div class="line">Set the <strong>DNS Profile</strong> to <strong>dns-block-mx</strong>.</div>
<div class="line"><a class="reference internal" href="media/image29.png"><img alt="image27" src="media/image29.png" style="width: 3.02244in; height: 2.63576in;" /></a></div>
</div>
</li>
<li><p class="first">Click <strong>Update</strong> to save your settings.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Logging Profiles</strong>.</p>
</li>
<li><p class="first">Click on the <strong>dns-dos-profile-logging</strong> logging profile name.</p>
</li>
<li><p class="first">Check <strong>Enabled</strong> next to <strong>Protocol Security</strong>.</p>
</li>
<li><div class="first line-block">
<div class="line">In the <strong>Protocol Security</strong> tab, set the <strong>DNS Security
Publisher</strong> to local-db-publisher and check all five of the
request log types.</div>
<div class="line"><a class="reference internal" href="media/image30.png"><img alt="image28" src="media/image30.png" style="width: 3.19205in; height: 5.75689in;" /></a></div>
</div>
</li>
<li><p class="first">Make sure that you click <strong>Update</strong> to save your settings.</p>
</li>
<li><div class="first line-block">
<div class="line">Return to the Attack Server SSH session and re-issue the MX query
command:</div>
<div class="line">dig &#64;10.20.0.10 MX example.com</div>
</div>
</li>
<li><p class="first">The query hangs as the BIG-IP is blocking the MX lookup.</p>
</li>
<li><div class="first line-block">
<div class="line">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Protocol</strong> &gt;
<strong>DNS</strong>. Observer the MX query drops.</div>
<div class="line"><a class="reference internal" href="media/image31.tiff"><img alt="image29" src="media/image31.tiff" style="width: 3.80132in; height: 1.11928in;" /></a></div>
</div>
</li>
</ol>
<p>This concludes the DNS portion of the lab. On the victim server, stop
the top utility by pressing <strong>CTRL + C</strong>.</p>
</div>
<div class="section" id="detecting-and-preventing-system-dos-and-ddos-attacks">
<h2>Detecting and Preventing System DoS and DDoS Attacks<a class="headerlink" href="#detecting-and-preventing-system-dos-and-ddos-attacks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="configure-logging">
<h3>Configure Logging<a class="headerlink" href="#configure-logging" title="Permalink to this headline">¶</a></h3>
<p>Configuring a logging destination will allow you to verify the BIG-IPs
detection and mitigation of attacks, in addition to the built-in
reporting.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong> &gt;
<strong>Device Configuration</strong> &gt; <strong>Properties</strong>.</p>
</li>
<li><p class="first">Under <strong>Log Pubisher</strong>, select <strong>local-db-publisher</strong>.</p>
</li>
<li><div class="first line-block">
<div class="line">Click the <strong>Commit Changes to System</strong> button.</div>
<div class="line"><a class="reference internal" href="media/image32.png"><img alt="image30" src="media/image32.png" style="width: 2.98013in; height: 1.62914in;" /></a></div>
</div>
</li>
</ol>
</div>
<div class="section" id="simulating-a-christmas-tree-packet-attack">
<h3>Simulating a Christmas Tree Packet Attack<a class="headerlink" href="#simulating-a-christmas-tree-packet-attack" title="Permalink to this headline">¶</a></h3>
<p>In this example, we’ll set the BIG-IP to detect and mitigate an attack
where all flags on a TCP packet are set. This is commonly referred to as
a Christmas tree packet and is intended to increase processing on
in-path network devices and end hosts to the target.</p>
<p>We’ll use the hping utility to send 25,000 packets to our server, with
random source IPs to simulate a DDoS attack where multiple hosts are
attacking our server. We’ll set the SYN, ACK, FIN, RST, URG, PUSH, Xmas
and Ymas TCP flags.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Bad-Header-TCP</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on the <strong>Bad TCP Flags (All Flags Set)</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ol class="loweralpha">
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: Specify 50</p>
</li>
<li><p class="first">Detection Threshold Percent: Specify 200</p>
</li>
<li><div class="first line-block">
<div class="line">Mitigation Threshold EPS: Specify 100</div>
<div class="line"><a class="reference internal" href="media/image33.png"><img alt="image31" src="media/image33.png" style="width: 2.43392in; height: 2.49669in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: tail -f /var/log/ltm</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following
command on the BASH prompt:</div>
<div class="line">sudo hping3 10.20.0.10 –flood –rand-source –destport 80 -c
25000 –syn –ack –fin –rst –push –urg –xmas –ymas</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">You’ll see the BIG-IP ltm log show that the attack has been
detected:</div>
<div class="line"><a class="reference internal" href="media/image34.tiff"><img alt="image32" src="media/image34.tiff" style="width: 4.48611in; height: 0.38889in;" /></a></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">After approximately 60 seconds, press <strong>CTRL+C</strong> to stop the
attack.</div>
<div class="line"><a class="reference internal" href="media/image35.tiff"><img alt="image33" src="media/image35.tiff" style="width: 4.43056in; height: 0.97222in;" /></a></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">Return to the BIG-IP web UI. Navigate to <strong>Security</strong> &gt; <strong>Event
Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt; <strong>Events</strong>. Observer the log
entries showing the details surrounding the attack detection and
mitigation.</div>
<div class="line"><a class="reference internal" href="media/image36.tiff"><img alt="image34" src="media/image36.tiff" style="width: 5.00000in; height: 1.70833in;" /></a></div>
</div>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Analysis</strong>.
Single-click on the attack ID in the filter list to the right of the
charts and observe the various statistics around the attack.</p>
</li>
</ol>
</div>
<div class="section" id="simulating-a-tcp-syn-ddos-attack">
<h3>Simulating a TCP SYN DDoS Attack<a class="headerlink" href="#simulating-a-tcp-syn-ddos-attack" title="Permalink to this headline">¶</a></h3>
<p>In the last example, we crafted a packet that is easily identified as
malicious, as its invalid. We’ll now simulate an attack with traffic
that could be normal, acceptable traffic. The TCP SYN flood attack will
attempt to DDoS a host by sending valid TCP traffic to a host from
multiple source hosts.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device</strong> <strong>Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Flood</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on <strong>TCP Syn Flood</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ol class="loweralpha">
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: 400</p>
</li>
<li><p class="first">Detection Threshold Percent: 500</p>
</li>
<li><div class="first line-block">
<div class="line">Mitigation Threshold EPS: 500</div>
<div class="line"><a class="reference internal" href="media/image37.png"><img alt="image35" src="media/image37.png" style="width: 2.45542in; height: 3.49669in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: tail -f /var/log/ltm</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following
command on the BASH prompt:</div>
<div class="line">sudo hping3 10.20.0.10 –flood –rand-source –destport 80 –syn
-d 120 -w 64</div>
</div>
</li>
<li><p class="first">After about 60 seconds, stop the flood attack by pressing <strong>CTRL +
C</strong>.</p>
</li>
<li><p class="first">Return to the BIG-IP web UI and navigate to <strong>Security</strong> &gt; <strong>Event
Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt; <strong>Events</strong>. Observe the log entries
showing the details surrounding the attack detection and mitigation.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Dashboard</strong>
to view an overview of the DoS attacks and timeline. You can select
filters in the filter pane to highlight the specific attack.</p>
</li>
<li><p class="first">Finally, navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt;
<strong>Analysis</strong>. View detailed statistics around the attack.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="preventing-global-dos-sweep-and-flood-attacks">
<h2>Preventing Global DoS Sweep and Flood Attacks<a class="headerlink" href="#preventing-global-dos-sweep-and-flood-attacks" title="Permalink to this headline">¶</a></h2>
<p>In the last section, the focus was on attacks originating from various
hosts. In this section, we will focus on mitigating flood and sweep
attacks from a single host.</p>
<p>The single endpoint sweep is an attempt for an attacker to send traffic
across a range of ports on the target server, typically to scan for open
ports.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Single-Endpoint</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on <strong>Single Endpoint Sweep</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ol class="loweralpha">
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: 150</p>
</li>
<li><p class="first">Mitigation Threshold EPS: 200</p>
</li>
<li><p class="first">Add Source Address to Category: Checked</p>
</li>
<li><p class="first">Category Name: denial_of_service</p>
</li>
<li><p class="first">Sustained Attack Detection Time: 10 seconds</p>
</li>
<li><p class="first">Category Duration Time: 60 seconds</p>
</li>
<li><div class="first line-block">
<div class="line">Packet Type: Move All IPv4 to Selected</div>
<div class="line"><a class="reference internal" href="media/image38.png"><img alt="image36" src="media/image38.png" style="width: 2.79540in; height: 6.25166in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Network Firewall</strong> &gt; <strong>IP
Intelligence</strong> &gt; <strong>Policies</strong>.</p>
</li>
<li><div class="first line-block">
<div class="line">In the <strong>Global Policy</strong> section, change the <strong>IP Intelligence
Policy</strong> to <strong>ip-intelligence</strong>.</div>
<div class="line"><a class="reference internal" href="media/image39.png"><img alt="image37" src="media/image39.png" style="width: 2.56954in; height: 0.91286in;" /></a></div>
</div>
</li>
<li><p class="first">Click <strong>Update</strong>.</p>
</li>
<li><p class="first">Click on the <strong>ip-intelligence</strong> policy in the policy list below.</p>
</li>
<li><p class="first">Create a new Blacklist Matching Policy in the IP Intelligence Policy
Properties section with the following attributes, leaving
unspecified attributes with their default values:</p>
<ol class="loweralpha simple">
<li>Blacklist Category: denial-of-service</li>
<li>Action: drop</li>
<li>Log Blacklist Category Matches: Yes</li>
</ol>
</li>
<li><div class="first line-block">
<div class="line">Click <strong>Add</strong> to add the new Blacklist Matching Policy.</div>
<div class="line"><a class="reference internal" href="media/image40.png"><img alt="image38" src="media/image40.png" style="width: 6.17881in; height: 3.91721in;" /></a></div>
</div>
</li>
<li><p class="first">Click <strong>Update</strong> to save changes to the ip-intelligence policy.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: tail -f /var/log/ltm</p>
</li>
<li><p class="first">On the victim server, start a packet capture with an SSH filter by
issuing sudo tcpdump -nn not port 22</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following
command on the BASH prompt:</div>
<div class="line">sudo hping3 10.20.0.10 –flood –scan 1-65535 -d 128 -w 64 –syn</div>
</div>
</li>
<li><p class="first">You will see the scan find a few open ports on the server, and the
server will show the inbound sweep traffic. However, you will notice
that the traffic to the server stops after a short time (10 seconds,
the configured sustained attack detection time.) Leave the test
running.</p>
</li>
<li><p class="first">After approximately 60 seconds, sweep traffic will return to the
host. This is because the IP Intelligence categorization of the
attack host has expired. After 10 seconds of traffic, the bad actor
is again blacklisted for another 60 seconds.</p>
</li>
<li><p class="first">Stop the sweep attack on the attack host by pressing <strong>CTRL + C</strong>.</p>
</li>
<li><p class="first">Return to the BIG-IP web UI and navigate to <strong>Security</strong> &gt; <strong>Event
Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt; <strong>Events</strong>. Observe the log entries
showing the details surrounding the attack detection and mitigation.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the log entries showing the mitigation of
the sweep attack via the ip-intelligence policy.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>Shun</strong>.
Observe the log entries showing the blacklist adds and deletes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the statistics showing the sweep attack and
mitigation. Change the <strong>View By</strong> drop-down to view the varying
statistics.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Dashboard</strong>
to view an overview of the DoS attacks and timeline. You can select
filters in the filter pane to highlight the specific attack.</p>
</li>
<li><p class="first">Finally, navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt;
<strong>Analysis</strong>. View detailed statistics around the attack.</p>
</li>
</ol>
<p>The single endpoint flood attack is an attempt for an attacker to send a
flood of traffic to a host in hopes of overwhelming a service to a point
of failure. In this example, we’ll flood the target server with ICMP
packets.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Single-Endpoint</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on <strong>Single Endpoint Flood</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ol class="loweralpha">
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: 150</p>
</li>
<li><p class="first">Mitigation Threshold EPS: 200</p>
</li>
<li><p class="first">Add Destination Address to Category: Checked</p>
</li>
<li><p class="first">Category Name: denial_of_service</p>
</li>
<li><p class="first">Sustained Attack Detection Time: 10 seconds</p>
</li>
<li><p class="first">Category Duration Time: 60 seconds</p>
</li>
<li><div class="first line-block">
<div class="line">Packet Type: Move Any ICMP (IPv4) to Selected</div>
<div class="line"><a class="reference internal" href="media/image41.png"><img alt="image39" src="media/image41.png" style="width: 2.41144in; height: 5.43046in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: tail -f /var/log/ltm</p>
</li>
<li><p class="first">We’ll run a packet capture on the victim server to gauge the
incoming traffic. On the victim server, issue the following command:
sudo tcpdump -nn not port 22</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following
command on the BASH prompt:</div>
<div class="line">sudo hping3 10.20.0.10 –faster -c 25000 –icmp</div>
</div>
</li>
<li><p class="first">The attack host will begin flooding the victim server with ICMP
packets. However, you will notice that the traffic to the server
stops after a short time (10 seconds, the configured sustained
attack detection time.)</p>
</li>
<li><p class="first">After approximately 60 seconds, run the attack again. ICMP traffic
will return to the host. This is because the IP Intelligence
categorization of the attack host has expired.</p>
</li>
<li><p class="first">Return to the BIG-IP web UI.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt;
<strong>Events</strong>. Observe the log entries showing the details surrounding
the attack detection and mitigation.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the log entries showing the mitigation of
the sweep attack via the ip-intelligence policy.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the statistics showing the sweep attack and
mitigation.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Dashboard</strong>
to view an overview of the DoS attacks and timeline. You can select
filters in the filter pane to highlight the specific attack.</p>
</li>
<li><p class="first">Finally, navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt;
<strong>Analysis</strong>. View detailed statistics around the attack.</p>
</li>
</ol>
<p>This concludes the DoS/DDoS portion of the lab. You may now close all
sessions, log out of the jump host and log out of the training portal.</p>
</div>
</div>
<div class="section" id="conclusion">
<h1><em>Conclusion</em><a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h1>
<p>Using the tools and configurations in this lab should help in setting up
a DoS/DDoS proof of concept. In the real world, you will likely use much
larger values for detection and mitigation thresholds.</p>
<p>This lab also did not cover auto thresholds for protections, nor did we
test dynamic signatures. Testing auto thresholds requires a more
real-world environment. For suggested testing guidelines for auto
thresholds and dynamic signatures, engage a Solutions Architect or
BIG-IP Security SME.</p>
</div>
<div class="section" id="appendix">
<h1><em>Appendix</em><a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h1>
<div class="section" id="software-download-locations">
<h2>Software Download Locations<a class="headerlink" href="#software-download-locations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>DNSPerf -
<a class="reference external" href="ftp://ftp.nominum.com/pub/nominum/dnsperf/2.1.0.0/dnsperf-src-2.1.0.0-1.tar.gz">ftp://ftp.nominum.com/pub/nominum/dnsperf/2.1.0.0/dnsperf-src-2.1.0.0-1.tar.gz</a></li>
<li>DNSPerf test file -
<a class="reference external" href="ftp://ftp.nominum.com/pub/nominum/dnsperf/data/queryfile-example-current.gz">ftp://ftp.nominum.com/pub/nominum/dnsperf/data/queryfile-example-current.gz</a></li>
</ul>
</div>
<div class="section" id="lab-build-images-and-sizing">
<h2>Lab build images and sizing<a class="headerlink" href="#lab-build-images-and-sizing" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>DNS server runs Ubuntu 17.10 LTS<ul>
<li>Installing bind9 from default repositories</li>
<li>1 vCPU, 2 GB RAM (keeping resources low to ease ability to stress)</li>
<li>20 GB HDD</li>
<li>SSH or console access</li>
</ul>
</li>
<li>DNS attack host runs Ubuntu 17.10 LTS<ul>
<li>Attack tools downloaded from links listed in “Software Download
Locations”</li>
<li>1 vCPU, 2 GB RAM</li>
<li>20 GB HDD</li>
<li>SSH or console access</li>
</ul>
</li>
<li>BIG-IP VE running BIGIP-13.1.0.1.0.0.8<ul>
<li>8 vCPU, 16 GB RAM, 150 GB storage</li>
<li>SSH or console access; GUI access</li>
<li>LTM, AFM and AVR provisioned</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="attack-host-build-from-scratch">
<h2>Attack Host Build from Scratch<a class="headerlink" href="#attack-host-build-from-scratch" title="Permalink to this headline">¶</a></h2>
<p>To build the attack host, you should begin with an Ubuntu 17.10 server
with the NIC configuration already competed. Internet access will be
required during the setup. We’ll download some tools and configure the
system with all required dependencies.</p>
<div class="section" id="dnsperf-install">
<h3>DNSPerf Install<a class="headerlink" href="#dnsperf-install" title="Permalink to this headline">¶</a></h3>
<p>Download the DNSPerf tool:</p>
<p>cd /tmp</p>
<p>wget
<a class="reference external" href="ftp://ftp.nominum.com/pub/nominum/dnsperf/2.1.0.0/dnsperf-src-2.1.0.0-1.tar.gz">ftp://ftp.nominum.com/pub/nominum/dnsperf/2.1.0.0/dnsperf-src-2.1.0.0-1.tar.gz</a></p>
<p>tar xvfz dnsperf-src-2.1.0.0-1.tar.gz</p>
<p>Once that file is completed, let’s install some dependencies, compile
and install:</p>
<p>sudo apt install gcc make libbind-dev libkrb5-dev libssl-dev libcap-dev
libxml2-dev libjson-glib-dev libgeoip-dev libjson-c-dev libjson-c3</p>
<p>cd /tmp/dnsperf-src-2.1.0.0-1</p>
<p>sudo ./configure</p>
<p>sudo make</p>
<p>sudo make install</p>
<p>At this point, you should be able to run DNSPerf (try it and press
CTRL+C to quit after it launches):</p>
<p><a class="reference internal" href="media/image42.png"><img alt="image40" src="media/image42.png" style="width: 5.52343in; height: 3.95519in;" /></a></p>
<p>DNSPerf has the ability to use a test file of preset DNS queries to
launch a barrage of DNS queries at a server. Let’s download that file:</p>
<p>cd ~/</p>
<p>wget
<a class="reference external" href="ftp://ftp.nominum.com/pub/nominum/dnsperf/data/queryfile-example-current.gz">ftp://ftp.nominum.com/pub/nominum/dnsperf/data/queryfile-example-current.gz</a></p>
<p>gunzip ~/queryfile-example-current.gz</p>
</div>
<div class="section" id="install-hping3">
<h3>Install hping3<a class="headerlink" href="#install-hping3" title="Permalink to this headline">¶</a></h3>
<p>Too easy:</p>
<p>sudo apt install hping3</p>
<p>Done!</p>
</div>
</div>
<div class="section" id="victim-server-setup-from-scratch">
<h2>Victim Server Setup from Scratch<a class="headerlink" href="#victim-server-setup-from-scratch" title="Permalink to this headline">¶</a></h2>
<p>To build the DNS server, you should begin with an Ubuntu 17.10 server
with the IP configuration already competed. We will need to install a
DNS server software package (bind9 in our case) and perform some basic
configuration to start serving up DNS replies.</p>
<p><strong>NOTE: These configurations are bare-minimum for a working lab server.
These steps in absolutely no way follow best practices for BIND
configuration and should not be referenced for configurations outside of
the scope of this lab!</strong></p>
<div class="section" id="install-bind9">
<h3>Install bind9<a class="headerlink" href="#install-bind9" title="Permalink to this headline">¶</a></h3>
<p>These are the steps to install bind9:</p>
<p>sudo apt install bind9 bind9utils</p>
<p>The installer may display additional packages that are dependencies.
When asked if you want to continue, enter <strong>Y</strong> and press <strong>*Enter*</strong>.</p>
<p>Congratulations! You’ve installed BIND. Let’s fire it up by issuing the
following command:</p>
<p>sudo service bind9 start</p>
<p>We can verify that the service by issuing the same command with the
status operator:</p>
<p>sudo service bind9 status</p>
<p>You will see output similar to below:</p>
<p><a class="reference internal" href="media/image43.png"><img alt="image41" src="media/image43.png" style="width: 6.16693in; height: 3.43709in;" /></a></p>
<p>Finally, let’s make sure BIND is started when the server boots. We do
that by issuing the following command:</p>
<p>sudo systemctl enable bind9</p>
<p>You should see output similar to below:</p>
<p><a class="reference internal" href="media/image44.png"><img alt="image42" src="media/image44.png" style="width: 7.00000in; height: 0.53819in;" /></a></p>
</div>
<div class="section" id="set-the-named-conf-options-configuration">
<h3>Set the named.conf.options configuration<a class="headerlink" href="#set-the-named-conf-options-configuration" title="Permalink to this headline">¶</a></h3>
<p>We must set our server to listen on the IP interface. Because we don’t
want to actually hammer any production DNS servers in the wild, we’ll
disable recursive lookups on this DNS server.</p>
<p>Edit the named.conf.options file by issuing the following command:</p>
<p>sudo nano /etc/bind/named.conf.options</p>
<p>Add the following 3 lines to the bottom of the configuration file:</p>
<p>recursion no;</p>
<p>listen-on { 10.10.0.50; 127.0.0.1; };</p>
<p>allow-transfer { none; };</p>
<p>Make sure your file looks like the example below:</p>
<p><a class="reference internal" href="media/image45.png"><img alt="image43" src="media/image45.png" style="width: 5.82609in; height: 3.50697in;" /></a></p>
<p>Finally, press Ctrl+X to Exit and save your changes.</p>
</div>
<div class="section" id="create-a-new-dns-zone">
<h3>Create a new DNS zone<a class="headerlink" href="#create-a-new-dns-zone" title="Permalink to this headline">¶</a></h3>
<p>Let’s create a zone file so we can start querying our DNS server. We’ll
copy an existing file to make it easier to create our zone file:</p>
<p>sudo cp /etc/bind/db.local /etc/bind/db.example.com</p>
<p>Now, let’s edit the new file:</p>
<p>sudo nano /etc/bind/db.example.com</p>
<p>You should see something very similar to this output:</p>
<p><a class="reference internal" href="media/image46.png"><img alt="image44" src="media/image46.png" style="width: 5.66078in; height: 3.55652in;" /></a></p>
<p>Modify all three instances of “localhost” to read “example.com” and
modify the 127.0.0.1 entry to match the actual server IP of
“10.10.0.50”. <strong>NOTE: FQDNs are required in this file!</strong> Finally, create
a few A records so we have something simple to test:</p>
<p>dnsserver IN A 10.10.0.50</p>
<p>www IN A 10.10.0.99</p>
<p>bigip IN A 10.10.0.11</p>
<p>bigiq IN A 10.10.0.25</p>
<p>The file should look similar to below when finished:</p>
<p><a class="reference internal" href="media/image47.png"><img alt="image45" src="media/image47.png" style="width: 7.00000in; height: 4.40208in;" /></a></p>
<p>Press <strong>CTRL + X</strong> to exit and save your work.</p>
<p>Now, let’s modify the named.conf.local file so BIND knows about our zone
file:</p>
<p>sudo nano /etc/bind/named.conf.local</p>
<p>We’ll add the following lines to the bottom of this file:</p>
<p>zone “example.com” {</p>
<p>type master;</p>
<p>file “/etc/bind/db.example.com”;</p>
<p>};</p>
<p>Your file should look similar to the output below when finished:</p>
<p><a class="reference internal" href="media/image48.png"><img alt="image46" src="media/image48.png" style="width: 7.00000in; height: 4.39792in;" /></a></p>
<p>Press CTRL+X to exit and save your changes.</p>
<p>Configuration is complete! Let’s restart the BIND service to initialize
these changes:</p>
<p>sudo service bind9 restart</p>
<p>After the service restarts, let’s test the BIND service:</p>
<p>dig &#64;10.10.0.50 <a class="reference external" href="http://www.example.com">www.example.com</a> +short</p>
<p>You should see a response for the www entry that you created:</p>
<p><a class="reference internal" href="media/image49.png"><img alt="image47" src="media/image49.png" style="width: 7.00000in; height: 0.40139in;" /></a></p>
<p>This concludes the DNS server build.</p>
</div>
</div>
<div class="section" id="dns-security-vectors">
<h2>DNS Security vectors<a class="headerlink" href="#dns-security-vectors" title="Permalink to this headline">¶</a></h2>
<p>The system tracks and rate limits all UDP DNS packets (excluding those
whitelisted). TCP DNS packets are also tracked but only for the DNS
requests that reach a virtual server that has a DNS profile associated
with it.</p>
<p><strong>NOTE: This information applies to 13.1.0.1. Check the documentation if
using a different version of TMOS.</strong></p>
<p>For vectors where VLAN is &lt;tunable&gt;, you can tune this value
in&nbsp;tmsh:&nbsp;modify sys db dos.dnsvlan&nbsp;value&nbsp;, where&nbsp;value&nbsp;is&nbsp;0-4094.</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="13%" />
<col width="11%" />
<col width="54%" />
<col width="13%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>DoS category</strong></th>
<th class="head"><strong>Attack name</strong></th>
<th class="head"><strong>Dos vector name</strong></th>
<th class="head"><strong>Information</strong></th>
<th class="head"><strong>Hardware accelerated</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>DNS</td>
<td>DNS A Query</td>
<td>dns-a-query</td>
<td>DNS Query, DNS Qtype is A_QRY, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>DNS</td>
<td>DNS AAAA Query</td>
<td>dns-aaaa-query</td>
<td>DNS Query, DNS Qtype is AAAA, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>DNS</td>
<td>DNS Any Query</td>
<td>dns-any-query</td>
<td>DNS Query, DNS Qtype is ANY_QRY, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>DNS</td>
<td>DNS AXFR Query</td>
<td>dns-axfr-query</td>
<td>DNS Query, DNS Qtype is AXFR, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>DNS</td>
<td>DNS CNAME Query</td>
<td>dns-cname-query</td>
<td>DNS Query, DNS Qtype is CNAME, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>DNS</td>
<td>DNS IXFR Query</td>
<td>dns-ixfr-query</td>
<td>DNS Query, DNS Qtype is IXFR, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>DNS</td>
<td>DNS Malformed</td>
<td>dns-malformed</td>
<td>Malformed DNS packet</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>DNS</td>
<td>DNS MX Query</td>
<td>dns-mx-query</td>
<td>DNS Query, DNS Qtype is MX, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>DNS</td>
<td>DNS NS Query</td>
<td>dns-ns-query</td>
<td>DNS Query, DNS Qtype is NS, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>DNS</td>
<td>DNS OTHER Query</td>
<td>dns-other-query</td>
<td>DNS Query, DNS Qtype is OTHER, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>DNS</td>
<td>DNS PTR Query</td>
<td>dns-ptr-query</td>
<td>DNS Query, DNS Qtype is PTR, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>DNS</td>
<td>DNS Question Items != 1</td>
<td>dns-qdcount-limit</td>
<td>DNS Query, DNS Qtype is ANY_QRY, the DNS query has more than one question.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>DNS</td>
<td>DNS Response Flood</td>
<td>dns-response-flood</td>
<td>UDP DNS Port=53, packet and DNS header flags bit 15 is 1 (response), VLAN is &lt;tunable&gt; in tmsh using&nbsp;dos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>DNS</td>
<td>DNS SOA Query</td>
<td>dns-soa-query</td>
<td>DNS Query, DNS Qtype is SOA_QRY, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>DNS</td>
<td>DNS SRV Query</td>
<td>dns-srv-query</td>
<td>DNS Query, DNS Qtype is SRV, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>DNS</td>
<td>DNS TXT Query</td>
<td>dns-txt-query</td>
<td>DNS Query, DNS Qtype is TXT, VLAN is &lt;tunable&gt; in tmsh usingdos.dnsvlan.</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="network-security-vectors">
<h2>Network Security Vectors<a class="headerlink" href="#network-security-vectors" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="15%" />
<col width="8%" />
<col width="64%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>DoS category</strong></th>
<th class="head"><strong>Attack name</strong></th>
<th class="head"><strong>Dos vector name</strong></th>
<th class="head"><strong>Information</strong></th>
<th class="head"><strong>Hardware accelerated</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Flood</td>
<td>Ethernet Broadcast Packet</td>
<td>ether-brdcst-pkt</td>
<td>Ethernet broadcast packet flood</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Flood</td>
<td>Ethernet Multicast Packet</td>
<td>ether-multicst-pkt</td>
<td>Ethernet destination is not broadcast, but is multicast</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Flood</td>
<td>ARP Flood</td>
<td>arp-flood</td>
<td>ARP packet flood</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Flood</td>
<td>IP Fragment Flood</td>
<td>ip-frag-flood</td>
<td>Fragmented packet flood with IPv4</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Flood</td>
<td>IGMP Flood</td>
<td>igmp-flood</td>
<td>Flood with IGMP packets (IPv4 packets with IP protocol number 2)</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Flood</td>
<td>Routing Header Type 0</td>
<td>routing-header-type-0</td>
<td>Routing header type zero is present in flood packets</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Flood</td>
<td>IPv6 Fragment Flood</td>
<td>ipv6-frag-flood</td>
<td>Fragmented packet flood with IPv6</td>
<td>No</td>
</tr>
<tr class="row-odd"><td>Flood</td>
<td>IGMP Fragment Flood</td>
<td>igmp-frag-flood</td>
<td>Fragmented packet flood with IGMP protocol</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Flood</td>
<td>TCP SYN Flood</td>
<td>tcp-syn-flood</td>
<td>TCP SYN flood</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Flood</td>
<td>TCP SYN ACK Flood</td>
<td>tcp-synack-flood</td>
<td>TCP SYN/ACK flood</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Flood</td>
<td>TCP RST Flood</td>
<td>tcp-rst-flood</td>
<td>TCP RST flood</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Flood</td>
<td>TCP Window Size</td>
<td>tcp-window-size</td>
<td>The TCP window size in packets is above the maximum. To tune this value, in&nbsp;tmsh:&nbsp;modify sys db dos.tcplowwindowsizevalue&nbsp;, where&nbsp;value&nbsp;is &lt;=128.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Flood</td>
<td>ICMPv4 Flood</td>
<td>icmpv4-flood</td>
<td>Flood with ICMP v4 packets</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Flood</td>
<td>ICMPv6 Flood</td>
<td>icmpv6-flood</td>
<td>Flood with ICMP v6 packets</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Flood</td>
<td>UDP Flood</td>
<td>udp-flood</td>
<td>UDP flood attack</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Flood</td>
<td>TCP SYN Oversize</td>
<td>tcp-syn-oversize</td>
<td>Detects TCP data SYN packets larger than the maximum specified by the dos.maxsynsize parameter. To tune this value, in&nbsp;tmsh:&nbsp;modify sys db dos.maxsynsize&nbsp;value&nbsp;. The default size is&nbsp;64&nbsp;and the maximum allowable value is&nbsp;9216.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Flood</td>
<td>TCP Push Flood</td>
<td>tcp-push-flood</td>
<td>TCP push packet flood</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Flood</td>
<td>TCP BADACK Flood</td>
<td>tcp-ack-flood</td>
<td>TCP ACK packet flood</td>
<td>No</td>
</tr>
<tr class="row-even"><td>Bad Header - L2</td>
<td>Ethernet MAC Source Address == Destination Address</td>
<td>ether-mac-sa-eq-da</td>
<td>Ethernet MAC source address equals the destination address</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv4</td>
<td>Bad IP Version</td>
<td>bad-ver</td>
<td>The IPv4 address version in the IP header is not 4</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv4</td>
<td>Header Length Too Short</td>
<td>hdr-len-too-short</td>
<td>IPv4 header length is less than 20 bytes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv4</td>
<td>Header Length &gt; L2 Length</td>
<td>hdr-len-gt-l2-len</td>
<td>No room in layer 2 packet for IP header (including options) for IPv4 address</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv4</td>
<td>L2 Length &gt;&gt; IP Length</td>
<td>l2-len-ggt-ip-len</td>
<td>Layer 2 packet length is much greater than the payload length in an IPv4 address header and the layer 2 length is greater than the minimum packet size</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv4</td>
<td>No L4</td>
<td>no-l4</td>
<td>No layer 4 payload for IPv4 address</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv4</td>
<td>Bad IP TTL Value</td>
<td>bad-ttl-val</td>
<td>Time-to-live equals zero for an IPv4 address</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv4</td>
<td>TTL &lt;= &lt;tunable&gt;</td>
<td>ttl-leq-one</td>
<td>An IP packet with a destination that is not multicast and that has a TTL greater than 0 and less than or equal to a tunable value, which is 1 by default. To tune this value, in&nbsp;tmsh:&nbsp;modify sys db dos.iplowttlvalue&nbsp;, where&nbsp;value&nbsp;is&nbsp;1-4.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv4</td>
<td>IP Error Checksum</td>
<td>ip-err-chksum</td>
<td>The header checksum is not correct</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv4</td>
<td>IP Option Frames</td>
<td>ip-opt-frames</td>
<td>IPv4 address packet with&nbsp;option.db variable tm.acceptipsourceroute&nbsp;must be enabled to receive IP options.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv4</td>
<td>Bad Source</td>
<td>ip-bad-src</td>
<td>The IPv4 source IP =&nbsp;255.255.255.255&nbsp;or&nbsp;0xe0000000U</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv4</td>
<td>IP Option Illegal Length</td>
<td>bad-ip-opt</td>
<td>Option present with illegal length</td>
<td>No</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv4</td>
<td>Unknown Option Type</td>
<td>unk-ipopt-type</td>
<td>Unknown IP option type</td>
<td>No</td>
</tr>
<tr class="row-odd"><td>Bad Header - IGMP</td>
<td>Bad IGMP Frame</td>
<td>bad-igmp-frame</td>
<td>IPv4 IGMP packets should have a header &gt;= 8 bytes. Bits 7:0 should be either 0x11, 0x12, 0x16, 0x22 or 0x17, or else the header is bad. Bits 15:8 should be non-zero only if bits 7:0 are 0x11, or else the header is bad.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Fragmentation</td>
<td>IP Fragment Too Small</td>
<td>ip-short-frag</td>
<td>IPv4 short fragment error</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Fragmentation</td>
<td>IPv6 Fragment Too Small</td>
<td>ipv6-short-frag</td>
<td>IPv6 short fragment error</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Fragmentation</td>
<td>IPV6 Atomic Fragment</td>
<td>ipv6-atomic-frag</td>
<td>IPv6 Frag header present with M=0 and FragOffset =0</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Fragmentation</td>
<td>ICMP Fragment</td>
<td>icmp-frag</td>
<td>ICMP fragment flood</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Fragmentation</td>
<td>IP Fragment Error</td>
<td>ip-other-frag</td>
<td>Other IPv4 fragment error</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Fragmentation</td>
<td>IPV6 Fragment Error</td>
<td>ipv6-other-frag</td>
<td>Other IPv6 fragment error</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Fragmentation</td>
<td>IP Fragment Overlap</td>
<td>ip-overlap-frag</td>
<td>IPv4 overlapping fragment error</td>
<td>No</td>
</tr>
<tr class="row-odd"><td>Fragmentation</td>
<td>IPv6 Fragment Overlap</td>
<td>ipv6-overlap-frag</td>
<td>IPv6 overlapping fragment error</td>
<td>No</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv6</td>
<td>Bad IPV6 Version</td>
<td>bad-ipv6-ver</td>
<td>The IPv6 address version in the IP header is not 6</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv6</td>
<td>IPV6 Length &gt; L2 Length</td>
<td>ipv6-len-gt-l2-len</td>
<td>IPv6 address length is greater than the layer 2 length</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv6</td>
<td>Payload Length &lt; L2 Length</td>
<td>payload-len-ls-l2-len</td>
<td>Specified IPv6 payload length is less than the L2 packet length</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv6</td>
<td>Too Many Extension Headers</td>
<td>too-many-ext-hdrs</td>
<td>For an IPv6 address, there are more than &lt;tunable&gt; extended headers (the default is&nbsp;4). To tune this value, in&nbsp;tmsh:&nbsp;modify sys db dos.maxipv6exthdrs&nbsp;value&nbsp;, where&nbsp;value&nbsp;is&nbsp;0-15.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv6</td>
<td>IPv6 duplicate extension headers</td>
<td>dup-ext-hdr</td>
<td>An extension header should occur only once in an IPv6 packet, except for the Destination Options extension header</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv6</td>
<td>IPv6 extension header too large</td>
<td>ext-hdr-too-large</td>
<td>An extension header is too large. To tune this value, in&nbsp;tmsh:&nbsp;modify sys db dos.maxipv6extsize&nbsp;value&nbsp;, where&nbsp;value&nbsp;is&nbsp;0-1024.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv6</td>
<td>No L4 (Extended Headers Go To Or Past End of Frame)</td>
<td>l4-ext-hdrs-go-end</td>
<td>Extended headers go to the end or past the end of the L4 frame</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv6</td>
<td>Bad IPV6 Hop Count</td>
<td>bad-ipv6-hop-cnt</td>
<td>Both the terminated (cnt=0) and forwarding packet (cnt=1) counts are bad</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv6</td>
<td>IPv6 hop count &lt;= &lt;tunable&gt;</td>
<td>hop-cnt-leq-one</td>
<td>The IPv6 extended header hop count is less than or equal to &lt;tunable&gt;. To tune this value, in&nbsp;tmsh:&nbsp;modify sys db dos.ipv6lowhopcntvalue&nbsp;, where&nbsp;value&nbsp;is&nbsp;1-4.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv6</td>
<td>IPv6 Extended Header Frames</td>
<td>ipv6-ext-hdr-frames</td>
<td>IPv6 address contains extended header frames</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv6</td>
<td>IPv6 extended headers wrong order</td>
<td>bad-ext-hdr-order</td>
<td>Extension headers in the IPv6 header are in the wrong order</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - IPv6</td>
<td>Bad IPv6 Addr</td>
<td>ipv6-bad-src</td>
<td>IPv6 source IP =&nbsp;0xff00:</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - IPv6</td>
<td>IPv4 Mapped IPv6</td>
<td>ipv4-mapped-ipv6</td>
<td>IPv4 address is in the lowest 32 bits of an IPv6 address.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - TCP</td>
<td>TCP Header Length Too Short (Length &lt; 5)</td>
<td>tcp-hdr-len-too-short</td>
<td>The Data Offset value in the TCP header is less than five 32-bit words</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - TCP</td>
<td>TCP Header Length &gt; L2 Length</td>
<td>tcp-hdr-len-gt-l2-len</td>
<td>&#160;</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - TCP</td>
<td>Unknown TCP Option Type</td>
<td>unk-tcp-opt-type</td>
<td>Unknown TCP option type</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - TCP</td>
<td>Option Present With Illegal Length</td>
<td>opt-present-with-illegal-len</td>
<td>Option present with illegal length</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - TCP</td>
<td>TCP Option Overruns TCP Header</td>
<td>tcp-opt-overruns-tcp-hdr</td>
<td>The TCP option bits overrun the TCP header</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - TCP</td>
<td>Bad TCP Checksum</td>
<td>bad-tcp-chksum</td>
<td>The TCP checksum does not match</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - TCP</td>
<td>Bad TCP Flags (All Flags Set)</td>
<td>bad-tcp-flags-all-set</td>
<td>Bad TCP flags (all flags set)</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - TCP</td>
<td>Bad TCP Flags (All Cleared)</td>
<td>bad-tcp-flags-all-clr</td>
<td>Bad TCP flags (all cleared and SEQ#=0)</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - TCP</td>
<td>SYN &amp;&amp; FIN Set</td>
<td>syn-and-fin-set</td>
<td>Bad TCP flags (SYN and FIN set)</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - TCP</td>
<td>FIN Only Set</td>
<td>fin-only-set</td>
<td>Bad TCP flags (only FIN is set)</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - TCP</td>
<td>TCP Flags - Bad URG</td>
<td>tcp-bad-urg</td>
<td>Packet contains a bad URG flag, this is likely malicious</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - ICMP</td>
<td>Bad ICMP Checksum</td>
<td>bad-icmp-chksum</td>
<td>An ICMP frame checksum is bad. Reuse the TCP or UDP checksum bits in the packet</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - ICMP</td>
<td>Bad ICMP Frame</td>
<td>bad-icmp-frame</td>
<td><p class="first">The ICMP frame is either the wrong size, or not of one of the valid IPv4 or IPv6 types. Valid IPv4 types:</p>
<ul class="simple">
<li>0 Echo Reply</li>
<li>3 Destination Unreachable</li>
<li>4 Source Quench</li>
<li>5 Redirect</li>
<li>8 Echo</li>
<li>11 Time Exceeded</li>
<li>12 Parameter Problem</li>
<li>13 Timestamp</li>
<li>14 Timestamp Reply</li>
<li>15 Information Request</li>
<li>16 Information Reply</li>
<li>17 Address Mask Request</li>
<li>18 Address Mask Reply</li>
</ul>
<p>Valid IPv6 types:</p>
<ul class="last simple">
<li>1 Destination Unreachable</li>
<li>2 Packet Too Big</li>
<li>3 Time Exceeded</li>
<li>4 Parameter Problem</li>
<li>128 Echo Request</li>
<li>129 Echo Reply</li>
<li>130 Membership Query</li>
<li>131 Membership Report</li>
<li>132 Membership Reduction</li>
</ul>
</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - ICMP</td>
<td>ICMP Frame Too Large</td>
<td>icmp-frame-too-large</td>
<td>The ICMP frame exceeds the declared IP data length or the maximum datagram length. To tune this value, in&nbsp;tmsh:&nbsp;modify sys db dos.maxicmpframesize&nbsp;value&nbsp;, where&nbsp;value&nbsp;is &lt;=65515.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - UDP</td>
<td>Bad UDP Header (UDP Length &gt; IP Length or L2 Length)</td>
<td>bad-udp-hdr</td>
<td>UDP length is greater than IP length or layer 2 length</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Bad Header - UDP</td>
<td>Bad UDP Checksum</td>
<td>bad-udp-chksum</td>
<td>The UDP checksum is not correct</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Other</td>
<td>Host Unreachable</td>
<td>host-unreachable</td>
<td>Host unreachable error</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Other</td>
<td>TIDCMP</td>
<td>tidcmp</td>
<td>ICMP source quench attack</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Other</td>
<td>LAND Attack</td>
<td>land-attack</td>
<td>Source IP equals destination IP address</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Other</td>
<td>IP Unknown protocol</td>
<td>ip-unk-prot</td>
<td>Unknown IP protocol</td>
<td>No</td>
</tr>
<tr class="row-odd"><td>Other</td>
<td>TCP Half Open</td>
<td>tcp-half-open</td>
<td>The number of new or untrusted TCP connections that can be established. Overrides the Global SYN Check threshold in Configuration &gt; Local Traffic &gt; General.</td>
<td>No</td>
</tr>
<tr class="row-even"><td>Other</td>
<td>IP uncommon proto</td>
<td>ip-uncommon-proto</td>
<td>Sets thresholds for and tracks packets containing IP protocols considered to be uncommon. By default, all IP protocols other than TCP, UDP, ICMP, IPV6-ICMP, and SCTP are on the IP uncommon protocol list.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Bad Header - DNS</td>
<td>DNS Oversize</td>
<td>dns-oversize</td>
<td>Detects oversized DNS headers. To tune this value, in&nbsp;tmsh:&nbsp;modify sys db dos.maxdnssize&nbsp;value&nbsp;, where&nbsp;value&nbsp;is&nbsp;256-8192.</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Single Endpoint</td>
<td>Single Endpoint Sweep</td>
<td>sweep</td>
<td>Sweep on a single endpoint. You can configure packet types to check for, and packets per second for both detection and rate limiting.</td>
<td>No</td>
</tr>
<tr class="row-odd"><td>Single Endpoint</td>
<td>Single Endpoint Flood</td>
<td>flood</td>
<td>Flood to a single endpoint. You can configure packet types to check for, and packets per second for both detection and rate limiting.</td>
<td>No</td>
</tr>
<tr class="row-even"><td>Bad Header-SCTP</td>
<td>Bad SCTP Checksum</td>
<td>bad-sctp-checksum</td>
<td>Bad SCTP packet checksum</td>
<td>No</td>
</tr>
</tbody>
</table>
</div>
</div>


        
      </div>
    </div>
  </div>


  <footer>
      <div class="container-fluid">
        <div class="row">
          <div class="content-fluid pre-footer">
            <div class="blocks-container">
              <div class="block">
                <h3>Support Programs</h3>
                <p>Regionally located support centers enable F5 to provide support in a number of languages through native-speaking support engineers.</p>
                <a class="btn internalLink" data-ng-href="https://f5.com/support/support-offerings" target="_blank" href="https://f5.com/support/support-offerings">See more
                  <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
                </a>
              </div>
              <div class="block">
                <h3>Contact Support</h3>
                <p>
                  North America: 1-888-882-7535<br>
                  Outside North America: 800-11-275-435
                </p>
                <a class="btn internalLink" data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" href="https://f5.com/about-us/contact#regional-support">Local Support Numbers
                  <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
                </a>
              </div>
              <div class="block">
                <h3>Feedback and Help</h3>
                <p>Have questions, suggestions, or just want to get something off your chest? Let us know.</p>
                <a class="btn" data-ui-sref="siteFeedback" target="_blank" href="https://support.f5.com/csp/siteFeedback">Leave feedback</a>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="footer">
            <div class="container">
              <div class="col-sm-3 col-md-2">
                <h4>About F5</h4>
                <ul>
                  <li><a data-ng-href="https://f5.com/about-us/contact" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact" class="internalLink">Contact F5</a>
                  </li>
                  <li><a data-ng-href="https://f5.com/about-us/careers" target="_blank" data-link-type="footer" href="https://f5.com/about-us/careers" class="internalLink">Careers</a>
                  </li>
                </ul>
              </div>
              <div class="col-sm-3 col-md-2">
                <h4>Education</h4>
                <ul>
                  <li><a data-ng-href="https://f5.com/education/training" target="_blank" data-link-type="footer" href="https://f5.com/education/training" class="internalLink">Training</a>
                  </li>
                  <li><a data-ng-href="https://f5.com/education/certification" target="_blank" data-link-type="footer" href="https://f5.com/education/certification" class="internalLink">Certification</a>
                  </li>
                  <li><a data-ng-href="https://f5.com/education/training/free-courses" target="_blank" data-link-type="footer" href="https://f5.com/education/training/free-courses" class="internalLink">Free Online Training</a>
                  </li>
                </ul>
              </div>

              <div class="col-sm-3 col-md-2">
                <h4>F5 sites</h4>
                <ul>
                <li><a data-ng-href="https://f5.com" target="_blank" data-link-type="footer" href="https://f5.com" class="internalLink">F5.com</a>
                </li>
                <li><a data-ng-href="https://devcentral.f5.com" target="_blank" data-link-type="footer" href="https://devcentral.f5.com" class="internalLink">Community</a>
                </li>
                <li><a data-ng-href="https://partners.f5.com" target="_blank" data-link-type="footer" href="https://partners.f5.com" class="internalLink">Partners</a>
                </li>
            </ul>
        </div>

        <div class="col-sm-3 col-md-2">
            <h4>Support Tasks</h4>
            <ul>
                <li><a data-ui-sref="mySupport.createServiceRequest" data-link-type="footer" href="https://support.f5.com/csp/my-support/service-request">Create Service Request </a>
                </li>
                <li><a data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact#regional-support" class="internalLink">Contact Support</a>
                </li>
                <li><a data-ui-sref="siteFeedback" target="_blank" data-link-type="footer" href="https://support.f5.com/csp/siteFeedback">Leave feedback [+]</a>
                </li>
            </ul>
        </div>

        <div class="col-xs-12 col-md-3 right">
            <h4>Connect with us</h4>
            <ul class="social_icons">
                <li><a href="//twitter.com/f5networks" target="_blank" data-name="twitter" data-type="" data-prefix="social" data-utf="E032" title="Twitter" class="externalLink"><i class="icon-1x icon-twitter icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a href="//www.linkedin.com/companies/f5-networks" target="_blank" class="linkedin externalLink" title="LinkedIn"><i class="icon-1x icon-linkedin icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a href="//www.facebook.com/f5networksinc" target="_blank" class="facebook externalLink" title="Facebook"><i class="icon-1x icon-facebook icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a href="//www.youtube.com/f5networksinc" target="_blank" class="youtube externalLink" title="YouTube"><i class="icon-1x icon-youtube icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a data-ng-href="https://devcentral.f5.com" target="_blank" class="devcentral internalLink" title="DevCentral" href="https://devcentral.f5.com"><i class="icon-1x icon-dc-pos icon-inverse-circle" data-link-type="footer"></i></a></li>
            </ul>
        </div>

        <div class="content-fluid left">
            <div class="col-xs-12">
                <p>
                    © Copyright <span class="ng-binding">2017</span> by F5 Networks, Inc. |
                    <a data-ng-href="https://f5.com/about-us/policies" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies" class="internalLink">Policies</a> |
                    <a data-ng-href="https://f5.com/about-us/policies/trademarks" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies/trademarks" class="internalLink">Trademarks</a>
                </p>
            </div>
        </div>
    </div>
</div>
    </div>
</div>
</footer>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="_static/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    jQuery.noConflict(true)
  </script>
  </body>
</html>